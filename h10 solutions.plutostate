Œ¥bonds€¬cell_resultsÙ$08937658-0dcd-11eb-2ed5-535e0256641d‡¦queuedÂ±published_objects€§runningÂ¦output…¤body °persist_js_stateÂ¤mimeªtext/plain²last_run_timestampËAØ9i’4Å¬rootassigneeÀ§cell_idÙ$08937658-0dcd-11eb-2ed5-535e0256641d§runtimeÌÈ§erroredÂÙ$343ff15c-0dd0-11eb-0d69-7179488c11d1‡¦queuedÂ±published_objects€§runningÂ¦output…¤body °persist_js_stateÂ¤mimeªtext/plain²last_run_timestampËAØ9i’4æy¬rootassigneeÀ§cell_idÙ$343ff15c-0dd0-11eb-0d69-7179488c11d1§runtimed§erroredÂÙ$1d69c848-0dc8-11eb-166a-a5fec7c97b6a‡¦queuedÂ±published_objects€§runningÂ¦output…¤bodyÙa<div class="markdown"><h2>A simple spatial model of atmosphere-ocean climate dynamics</h2>
</div>°persist_js_stateÂ¤mime©text/html²last_run_timestampËAØ9i’3¨¬rootassigneeÀ§cell_idÙ$1d69c848-0dc8-11eb-166a-a5fec7c97b6a§runtimeÍ§erroredÂÙ$af1ed97c-0dcd-11eb-3357-338aa6045322‡¦queuedÂ±published_objects€§runningÂ¦output…¤body °persist_js_stateÂ¤mimeªtext/plain²last_run_timestampËAØ9i’4€|¬rootassigneeÀ§cell_idÙ$af1ed97c-0dcd-11eb-3357-338aa6045322§runtimed§erroredÂÙ$0be9a322-0dcd-11eb-1258-97300c0b9d65‡¦queuedÂ±published_objects€§runningÂ¦output…¤bodyÙß<div class="markdown"><h5>Adding a latitudinal dependence to the solar insolation</h5>
<p>TO DO: Add a simple formula for the latitudinal dependence of insolation &#40;in W/m<span class="tex">$^2$</span>/m ?&#41;</p>
</div>°persist_js_stateÂ¤mime©text/html²last_run_timestampËAØ9i’4òÔ¬rootassigneeÀ§cell_idÙ$0be9a322-0dcd-11eb-1258-97300c0b9d65§runtimeÍ§erroredÂÙ$f89ca0ba-0dce-11eb-3327-ad9b1af679ac‡¦queuedÂ±published_objects€§runningÂ¦output…¤bodyÙ¢<div class="markdown"><h5>Velocity field of a typical subtropic ocean gyre</h5>
<p>TO DO: Code up analytical solution from Vallis or Pedloskly textbook</p>
</div>°persist_js_stateÂ¤mime©text/html²last_run_timestampËAØ9i’4=Ñ¬rootassigneeÀ§cell_idÙ$f89ca0ba-0dce-11eb-3327-ad9b1af679ac§runtimeÍ0§erroredÂÙ$714d1bf4-0dc8-11eb-0fe0-3b52dc7a4d35‡¦queuedÂ±published_objects€§runningÂ¦output…¤bodyÚl<div class="markdown"><p>Consider the temperature <span class="tex">$T&#40;x,y,t&#41;$</span> evolution equation</p>
<p class="tex">$$\frac&#123;\partial T&#125;&#123;\partial t&#125; &#61; - \frac&#123;\partial&#125;&#123;\partial x&#125;\left&#40; uT - \kappa \frac&#123;\partial T&#125;&#123;\partial x&#125; \right&#41; - \frac&#123;\partial&#125;&#123;\partial y&#125;\left&#40; vT - \kappa \frac&#123;\partial T&#125;&#123;\partial y&#125; \right&#41; &#43; \frac&#123;&#40;1 - Î±&#41;S&#125;&#123;4C&#125; - \left&#40;\frac&#123;A&#125;&#123;C&#125; &#43; \frac&#123;B&#125;&#123;C&#125;T \right&#41;$$</p>
</div>°persist_js_stateÂ¤mime©text/html²last_run_timestampËAØ9i’42 ¬rootassigneeÀ§cell_idÙ$714d1bf4-0dc8-11eb-0fe0-3b52dc7a4d35§runtimeÍD§erroredÂÙ$55a4467a-0dc8-11eb-2497-89398cd58b43‡¦queuedÂ±published_objects€§runningÂ¦output…¤bodyÚ•<div class="markdown"><p>Recall the zero-dimensional energy balance model of Earth&#39;s climate from Lecture <strong>??</strong>:</p>
<p>\begin&#123;align&#125; \text&#123;\color&#123;brown&#125;&#123;change in heat content&#125;&#125; &#61; &amp;\;\quad \text&#123;\color&#123;orange&#125;&#123;absorbed solar radiation&#125;&#125; \newline &amp; - \text&#123;\color&#123;blue&#125;&#123;thermal cooling to space&#125;&#125; \end&#123;align&#125;</p>
<p>or </p>
<p>\begin&#123;gather&#125; \color&#123;brown&#125;&#123;C \frac&#123;dT&#125;&#123;dt&#125;&#125; \; \color&#123;black&#125;&#123;&#61;&#125; \; \color&#123;orange&#125;&#123;\frac&#123;&#40;1 - Î±&#41;S&#125;&#123;4&#125;&#125; \; \color&#123;black&#125;&#123;-&#125; \; \color&#123;blue&#125;&#123;&#40;A &#43; BT&#41;&#125; \end&#123;gather&#125;</p>
<p>where <span class="tex">$T&#40;t&#41;$</span> was only a function of temperature and the equation was thus an <strong>Ordinary Differential Equation &#40;ODE&#41;</strong>.</p>
<p>In this notebook, we will expand the model to the spatial dimensions <span class="tex">$\mathbf&#123;x&#125;$</span> &#40;longitude, or West-East&#41; and <span class="tex">$\mathbf&#123;y&#125;$</span> &#40;latitude, or South-North&#41;, and will allow ocean currents to transport heat from one grid cell &#40;<span class="tex">$T_&#123;i,j&#125;$</span>&#41; to a neighboring grid cell &#40;<span class="tex">$T_&#123;i \pm 1,\, j&#125;$</span> or <span class="tex">$T_&#123;i,\, j \pm 1&#125;$</span>&#41;.</p>
<p>\begin&#123;align&#125; \text&#123;\color&#123;brown&#125;&#123;change in heat content&#125;&#125; &#61; &amp;\;\quad \text&#123;\color&#123;orange&#125;&#123;absorbed solar radiation&#125;&#125; \newline &amp; - \text&#123;\color&#123;blue&#125;&#123;thermal cooling to space&#125;&#125; \newline &amp; - \text&#123;\color&#123;purple&#125;&#123;heat export by ocean currents&#125;&#125;  \end&#123;align&#125;</p>
</div>°persist_js_stateÂ¤mime©text/html²last_run_timestampËAØ9i’3»(¬rootassigneeÀ§cell_idÙ$55a4467a-0dc8-11eb-2497-89398cd58b43§runtimeÍ:˜§erroredÂÙ$5574d9cc-0dcc-11eb-2a94-cfef3a89cd40‡¦queuedÂ±published_objects€§runningÂ¦output…¤bodyÙC<div class="markdown"><h3>Adding oceanic heat transport</h3>
</div>°persist_js_stateÂ¤mime©text/html²last_run_timestampËAØ9i’4'=¬rootassigneeÀ§cell_idÙ$5574d9cc-0dcc-11eb-2a94-cfef3a89cd40§runtimeÍÌ§erroredÂÙ$ae55d0d4-0dcd-11eb-30bc-c19b44a332fc‡¦queuedÂ±published_objects€§runningÂ¦output…¤body °persist_js_stateÂ¤mimeªtext/plain²last_run_timestampËAØ9i’55¬rootassigneeÀ§cell_idÙ$ae55d0d4-0dcd-11eb-30bc-c19b44a332fc§runtimeÌÈ§erroredÂÙ$a9601cec-0dca-11eb-0497-7d4a7966a459‡¦queuedÂ±published_objects€§runningÂ¦output…¤bodyÚ <div class="markdown"><h4>Adding spatial dimensions to our energy balance model</h4>
<p>For simplicity, we will start by adding spatial dimensions to our energy balance model without any other additional complexities, such as the transport of heat from one location to another.</p>
</div>°persist_js_stateÂ¤mime©text/html²last_run_timestampËAØ9i’3Ç¬rootassigneeÀ§cell_idÙ$a9601cec-0dca-11eb-0497-7d4a7966a459§runtimeÍÔ§erroredÂÙ$d0483e1c-0dc9-11eb-2db3-89434516a36d‡¦queuedÂ±published_objects€§runningÂ¦output…¤bodyÚª<div class="markdown"><p>We want to solve the equation</p>
<p>\begin&#123;gather&#125; \color&#123;brown&#125;&#123;C \frac&#123;\partial T&#125;&#123;\partial t&#125;&#125; \; \color&#123;black&#125;&#123;&#61;&#125; \; \color&#123;orange&#125;&#123;\frac&#123;&#40;1 - Î±&#41;S&#125;&#123;4&#125;&#125; \; \color&#123;black&#125;&#123;-&#125; \; \color&#123;blue&#125;&#123;&#40;A &#43; BT&#41;&#125; \end&#123;gather&#125;</p>
<p>where we now allow <span class="tex">$T &#61; T&#40;x,y,t&#41;$</span> to be a function of <span class="tex">$x$</span> &#40;longitude&#41;, <span class="tex">$y$</span> &#40;latitude&#41;, and <span class="tex">$t$</span> &#40;time&#41;.</p>
<p>The discretized form of this equation,</p>
<p class="tex">$$T_&#123;i,\, j,\, n&#43;1&#125; &#61; T_&#123;i,\, j,\, n&#125; &#43; \Delta t \left&#91; \frac&#123;1&#125;&#123;C&#125; \left&#40; \frac&#123; \left&#40; 1-\alpha&#40;T_&#123;i,\, j,\, n&#125;&#41; \right&#41; S&#125;&#123;4&#125; - &#40;A &#43; BT_&#123;i,\, j,\, n&#125;&#41; \right&#41; \right&#93;$$</p>
<p>shows that the future temperature <span class="tex">$T_&#123;i,j,n&#43;1&#125;$</span> in the <code>&#40;i,j&#41;</code> cell only requires knowledge of the present temperature <span class="tex">$T_&#123;i,j,n&#125;$</span> that same cell.</p>
<p>Thus, the discretized two-dimensional problems simple amounts to solving the zero-dimensional energy balance model in each cell of the grid.</p>
</div>°persist_js_stateÂ¤mime©text/html²last_run_timestampËAØ9i’3×„¬rootassigneeÀ§cell_idÙ$d0483e1c-0dc9-11eb-2db3-89434516a36d§runtimeÍ¥§erroredÂÙ$643ecc8a-0dcf-11eb-1b50-f30a098dfff7‡¦queuedÂ±published_objects€§runningÂ¦output…¤bodyÙM<div class="markdown"><h5>Building intuition about heat transport</h5>
</div>°persist_js_stateÂ¤mime©text/html²last_run_timestampËAØ9i’4‹¬¬rootassigneeÀ§cell_idÙ$643ecc8a-0dcf-11eb-1b50-f30a098dfff7§runtimeÍÀ§erroredÂ±cell_dependenciesÙ$08937658-0dcd-11eb-2ed5-535e0256641d„´precedence_heuristic§cell_idÙ$08937658-0dcd-11eb-2ed5-535e0256641d´downstream_cells_map€²upstream_cells_map€Ù$343ff15c-0dd0-11eb-0d69-7179488c11d1„´precedence_heuristic§cell_idÙ$343ff15c-0dd0-11eb-0d69-7179488c11d1´downstream_cells_map€²upstream_cells_map€Ù$1d69c848-0dc8-11eb-166a-a5fec7c97b6a„´precedence_heuristic§cell_idÙ$1d69c848-0dc8-11eb-166a-a5fec7c97b6a´downstream_cells_map€²upstream_cells_map‚§@md_str¨getindexÙ$af1ed97c-0dcd-11eb-3357-338aa6045322„´precedence_heuristic§cell_idÙ$af1ed97c-0dcd-11eb-3357-338aa6045322´downstream_cells_map€²upstream_cells_map€Ù$0be9a322-0dcd-11eb-1258-97300c0b9d65„´precedence_heuristic§cell_idÙ$0be9a322-0dcd-11eb-1258-97300c0b9d65´downstream_cells_map€²upstream_cells_map‚§@md_str¨getindexÙ$f89ca0ba-0dce-11eb-3327-ad9b1af679ac„´precedence_heuristic§cell_idÙ$f89ca0ba-0dce-11eb-3327-ad9b1af679ac´downstream_cells_map€²upstream_cells_map‚§@md_str¨getindexÙ$714d1bf4-0dc8-11eb-0fe0-3b52dc7a4d35„´precedence_heuristic§cell_idÙ$714d1bf4-0dc8-11eb-0fe0-3b52dc7a4d35´downstream_cells_map€²upstream_cells_map‚§@md_str¨getindexÙ$55a4467a-0dc8-11eb-2497-89398cd58b43„´precedence_heuristic§cell_idÙ$55a4467a-0dc8-11eb-2497-89398cd58b43´downstream_cells_map€²upstream_cells_map‚§@md_str¨getindexÙ$5574d9cc-0dcc-11eb-2a94-cfef3a89cd40„´precedence_heuristic§cell_idÙ$5574d9cc-0dcc-11eb-2a94-cfef3a89cd40´downstream_cells_map€²upstream_cells_map‚§@md_str¨getindexÙ$ae55d0d4-0dcd-11eb-30bc-c19b44a332fc„´precedence_heuristic§cell_idÙ$ae55d0d4-0dcd-11eb-30bc-c19b44a332fc´downstream_cells_map€²upstream_cells_map€Ù$a9601cec-0dca-11eb-0497-7d4a7966a459„´precedence_heuristic§cell_idÙ$a9601cec-0dca-11eb-0497-7d4a7966a459´downstream_cells_map€²upstream_cells_map‚§@md_str¨getindexÙ$d0483e1c-0dc9-11eb-2db3-89434516a36d„´precedence_heuristic§cell_idÙ$d0483e1c-0dc9-11eb-2db3-89434516a36d´downstream_cells_map€²upstream_cells_map‚§@md_str¨getindexÙ$643ecc8a-0dcf-11eb-1b50-f30a098dfff7„´precedence_heuristic§cell_idÙ$643ecc8a-0dcf-11eb-1b50-f30a098dfff7´downstream_cells_map€²upstream_cells_map‚§@md_str¨getindex´cell_execution_orderÙ$1d69c848-0dc8-11eb-166a-a5fec7c97b6aÙ$55a4467a-0dc8-11eb-2497-89398cd58b43Ù$a9601cec-0dca-11eb-0497-7d4a7966a459Ù$d0483e1c-0dc9-11eb-2db3-89434516a36dÙ$08937658-0dcd-11eb-2ed5-535e0256641dÙ$5574d9cc-0dcc-11eb-2a94-cfef3a89cd40Ù$714d1bf4-0dc8-11eb-0fe0-3b52dc7a4d35Ù$f89ca0ba-0dce-11eb-3327-ad9b1af679acÙ$af1ed97c-0dcd-11eb-3357-338aa6045322Ù$643ecc8a-0dcf-11eb-1b50-f30a098dfff7Ù$343ff15c-0dd0-11eb-0d69-7179488c11d1Ù$0be9a322-0dcd-11eb-1258-97300c0b9d65Ù$ae55d0d4-0dcd-11eb-30bc-c19b44a332fc©shortpath°h10 solutions.jl®process_status¥ready¤pathÙF/home/runner/work/disorganised-mess/disorganised-mess/h10 solutions.jlªcell_orderÙ$1d69c848-0dc8-11eb-166a-a5fec7c97b6aÙ$55a4467a-0dc8-11eb-2497-89398cd58b43Ù$a9601cec-0dca-11eb-0497-7d4a7966a459Ù$d0483e1c-0dc9-11eb-2db3-89434516a36dÙ$08937658-0dcd-11eb-2ed5-535e0256641dÙ$5574d9cc-0dcc-11eb-2a94-cfef3a89cd40Ù$714d1bf4-0dc8-11eb-0fe0-3b52dc7a4d35Ù$f89ca0ba-0dce-11eb-3327-ad9b1af679acÙ$af1ed97c-0dcd-11eb-3357-338aa6045322Ù$643ecc8a-0dcf-11eb-1b50-f30a098dfff7Ù$343ff15c-0dd0-11eb-0d69-7179488c11d1Ù$0be9a322-0dcd-11eb-1258-97300c0b9d65Ù$ae55d0d4-0dcd-11eb-30bc-c19b44a332fc¥nbpkg„²installed_versions€§enabledÃ·restart_recommended_msgÀ´restart_required_msgÀ«cell_inputsÙ$08937658-0dcd-11eb-2ed5-535e0256641dƒ§cell_idÙ$08937658-0dcd-11eb-2ed5-535e0256641d¤code «code_foldedÂÙ$343ff15c-0dd0-11eb-0d69-7179488c11d1ƒ§cell_idÙ$343ff15c-0dd0-11eb-0d69-7179488c11d1¤codeÙ# Heat maps of heat transport in x and y

# Heat maps of heat convergence in x and y

# Heat map of buoyuancy flux magnitude & visualization of divergence (?)«code_foldedÂÙ$1d69c848-0dc8-11eb-166a-a5fec7c97b6aƒ§cell_idÙ$1d69c848-0dc8-11eb-166a-a5fec7c97b6a¤codeÙHmd"""
## A simple spatial model of atmosphere-ocean climate dynamics
"""«code_foldedÃÙ$af1ed97c-0dcd-11eb-3357-338aa6045322ƒ§cell_idÙ$af1ed97c-0dcd-11eb-3357-338aa6045322¤codeÙ&# Quiver plots of velocity field (u,v)«code_foldedÂÙ$0be9a322-0dcd-11eb-1258-97300c0b9d65ƒ§cell_idÙ$0be9a322-0dcd-11eb-1258-97300c0b9d65¤codeÙ¢md"""
##### Adding a latitudinal dependence to the solar insolation

TO DO: Add a simple formula for the latitudinal dependence of insolation (in W/m$^2$/m ?)
"""«code_foldedÃÙ$f89ca0ba-0dce-11eb-3327-ad9b1af679acƒ§cell_idÙ$f89ca0ba-0dce-11eb-3327-ad9b1af679ac¤codeÙ†md"""
##### Velocity field of a typical subtropic ocean gyre

TO DO: Code up analytical solution from Vallis or Pedloskly textbook
"""«code_foldedÂÙ$714d1bf4-0dc8-11eb-0fe0-3b52dc7a4d35ƒ§cell_idÙ$714d1bf4-0dc8-11eb-0fe0-3b52dc7a4d35¤codeÚQmd"""
Consider the temperature $T(x,y,t)$ evolution equation

$\frac{\partial T}{\partial t} = - \frac{\partial}{\partial x}\left( uT - \kappa \frac{\partial T}{\partial x} \right) - \frac{\partial}{\partial y}\left( vT - \kappa \frac{\partial T}{\partial y} \right) + \frac{(1 - Î±)S}{4C} - \left(\frac{A}{C} + \frac{B}{C}T \right)$
"""«code_foldedÂÙ$55a4467a-0dc8-11eb-2497-89398cd58b43ƒ§cell_idÙ$55a4467a-0dc8-11eb-2497-89398cd58b43¤codeÚtmd"""
Recall the zero-dimensional energy balance model of Earth's climate from Lecture **??**:

\begin{align}
\text{\color{brown}{change in heat content}} = &\;\quad \text{\color{orange}{absorbed solar radiation}} \newline
& - \text{\color{blue}{thermal cooling to space}}
\end{align}

or 

\begin{gather}
\color{brown}{C \frac{dT}{dt}}
\; \color{black}{=} \; \color{orange}{\frac{(1 - Î±)S}{4}}
\; \color{black}{-} \; \color{blue}{(A + BT)}
\end{gather}

where $T(t)$ was only a function of temperature and the equation was thus an **Ordinary Differential Equation (ODE)**.

In this notebook, we will expand the model to the spatial dimensions $\mathbf{x}$ (longitude, or West-East) and $\mathbf{y}$ (latitude, or South-North), and will allow ocean currents to transport heat from one grid cell ($T_{i,j}$) to a neighboring grid cell ($T_{i \pm 1,\, j}$ or $T_{i,\, j \pm 1}$).

\begin{align}
\text{\color{brown}{change in heat content}} =
&\;\quad \text{\color{orange}{absorbed solar radiation}} \newline
& - \text{\color{blue}{thermal cooling to space}} \newline
& - \text{\color{purple}{heat export by ocean currents}} 
\end{align}

"""«code_foldedÂÙ$5574d9cc-0dcc-11eb-2a94-cfef3a89cd40ƒ§cell_idÙ$5574d9cc-0dcc-11eb-2a94-cfef3a89cd40¤codeÙ+md"""
### Adding oceanic heat transport
"""«code_foldedÃÙ$ae55d0d4-0dcd-11eb-30bc-c19b44a332fcƒ§cell_idÙ$ae55d0d4-0dcd-11eb-30bc-c19b44a332fc¤code «code_foldedÂÙ$a9601cec-0dca-11eb-0497-7d4a7966a459ƒ§cell_idÙ$a9601cec-0dca-11eb-0497-7d4a7966a459¤codeÚmd"""
#### Adding spatial dimensions to our energy balance model

For simplicity, we will start by adding spatial dimensions to our energy balance model without any other additional complexities, such as the transport of heat from one location to another.

"""«code_foldedÃÙ$d0483e1c-0dc9-11eb-2db3-89434516a36dƒ§cell_idÙ$d0483e1c-0dc9-11eb-2db3-89434516a36d¤codeÚ:md"""

We want to solve the equation

\begin{gather}
\color{brown}{C \frac{\partial T}{\partial t}}
\; \color{black}{=} \; \color{orange}{\frac{(1 - Î±)S}{4}}
\; \color{black}{-} \; \color{blue}{(A + BT)}
\end{gather}

where we now allow $T = T(x,y,t)$ to be a function of $x$ (longitude), $y$ (latitude), and $t$ (time).

The discretized form of this equation,

$T_{i,\, j,\, n+1} = T_{i,\, j,\, n} + \Delta t \left[ \frac{1}{C} \left( \frac{ \left( 1-\alpha(T_{i,\, j,\, n}) \right) S}{4} - (A + BT_{i,\, j,\, n}) \right) \right]$

shows that the future temperature $T_{i,j,n+1}$ in the `(i,j)` cell only requires knowledge of the present temperature $T_{i,j,n}$ that same cell.

Thus, the discretized two-dimensional problems simple amounts to solving the zero-dimensional energy balance model in each cell of the grid.
"""«code_foldedÃÙ$643ecc8a-0dcf-11eb-1b50-f30a098dfff7ƒ§cell_idÙ$643ecc8a-0dcf-11eb-1b50-f30a098dfff7¤codeÙ7md"""
##### Building intuition about heat transport
"""«code_foldedÂ«notebook_idÙ$d0f422be-df23-11eb-3255-a106d5f13bd0«in_temp_dirÂ